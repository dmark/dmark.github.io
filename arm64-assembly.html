<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Person">
<head>
  <meta charset="utf-8">
  <!-- Site Meta Data -->
  <title>A Tiny Bit of ARM64 Assembly</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Mark Drummond">

  <link rel="shortcut icon" href="">

  <!-- schema.org -->
  <meta itemprop="name" content="md">
  <meta itemprop="image" content="">
  <meta itemprop="description" content="">

  <!-- Style Meta Data -->
  <link rel="stylesheet" href="https://markdrummond.ca/theme/css/milligram.css" type="text/css" />
  <link rel="stylesheet" href="https://markdrummond.ca/theme/css/custom.css" type="text/css" />

  <!-- Feed Meta Data -->

  <!-- Twitter Feed -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="">
  <meta name="twitter:image" content="">

<meta name="twitter:creator" content="">
<meta name="twitter:url" content="https://markdrummond.ca/arm64-assembly.html">
<meta name="twitter:title" content="md ~ A Tiny Bit of ARM64 Assembly">
<meta name="twitter:description" content="A Tiny Bit of ARM64 Assembly">

<!-- Facebook Meta Data -->
<meta property="og:title" content="md ~ A Tiny Bit of ARM64 Assembly" />
<meta property="og:description" content="A Tiny Bit of ARM64 Assembly" />
<meta property="og:image" content="" />
</head>

<body>
    <div class="container">

    <!-- Navbar -->
      <div class="navbar">
        <ul>
            <div>
                <li>
                    <a href="https://markdrummond.ca"><h3>md</h3></a>
                </li>
                <li>
                        <em><h6>Move slow and fix things</h6></em>
                </li>
            </div>
        </ul>
      </div>

  <!-- Sidebar -->
    <sidebar>
        <ul class="static-item">
                <li><a href="https://idpro.org/">IDPro.org</a></li>
                <li><a href="https://www.isc2.org/">ISC2</a></li>

                <li><a href="https://markdrummond.ca/pages/about.html">About</a></li>
        </ul>        

        <ul>
        </ul>

   
        <p> 
                <span>
                    <a href="https://www.linkedin.com/in/medrummond/" target="_blank">
                        <img class="social-icons-m" src="https://markdrummond.ca/theme/images/icons/linkedin.png">
                    </a>
                </span>
                <span>
                    <a href="https://github.com/dmark" target="_blank">
                        <img class="social-icons-m" src="https://markdrummond.ca/theme/images/icons/github.png">
                    </a>
                </span>
        </p>
        <p>
        </p>
        <p>
        </p>
    </sidebar>
    
    <maincontent>
<h2>
    <a href="https://markdrummond.ca/arm64-assembly.html" rel="bookmark" title="Permalink to A Tiny Bit of ARM64 Assembly">A Tiny Bit of ARM64 Assembly</a>
</h2>

<div>
    <b>By: </b><a href="https://markdrummond.ca/author/mark-drummond.html">Mark Drummond</a><b>    On: </b>Sat 15 February 2025<br />
    <b>In: </b><a href="https://markdrummond.ca/category/programming.html" rel="bookmark" title="Permalink to Programming">Programming</a><br />
    <em><b>Tags: </b>
                <span><a href="https://markdrummond.ca/tag/arm.html">#arm </a></span>
                <span><a href="https://markdrummond.ca/tag/programming.html">#programming </a></span>
    </em>
    <hr>
</div>

<div>
    <mainarticle>
    <p>Experienced programmers with time on their side always insist you should know how to program in C, and you should be able to read assembly. Maybe they are right. Or maybe they have the good fortune to be able to pontificate from on high. I mean, I agree with them. I strongly believe everyone who works in technology (in, not just with), should know what is happening under the hood. But maybe I am wrong.</p>
<p>If you do want to start learning to read assembly, where and how do you start? The time honoured tradition here is: write a simple program in C, compile it, disassemble it, and compare the two.</p>
<p>If you are on a Mac, you can use <code>clang</code> to compile your C code, and <code>otool</code> to do the disassembly. If you have a full C/C++ IDE available, it likely has a disassembler built in.</p>
<p>Start with some simple math, and use small numbers. This makes it easy to see the numbers in the assembly code. Take this bit of C for example:</p>
<div class="highlight"><pre><span></span><code>int main()
{
    int a,b,c;
    a=5;
    b=7;
    c=a+b;
}
</code></pre></div>

<p>It should be clear what is happening here. Compile it, and then disassemble it:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>make<span class="w"> </span>foo
cc<span class="w">     </span>foo.c<span class="w">   </span>-o<span class="w"> </span>foo
$<span class="w"> </span>otool<span class="w"> </span>-tv<span class="w"> </span>foo
foo:
<span class="o">(</span>__TEXT,__text<span class="o">)</span><span class="w"> </span>section
_main:
0000000100003f78<span class="w">        </span>sub<span class="w">     </span>sp,<span class="w"> </span>sp,<span class="w"> </span><span class="c1">#0x10</span>
0000000100003f7c<span class="w">        </span>mov<span class="w">     </span>w8,<span class="w"> </span><span class="c1">#0x5</span>
0000000100003f80<span class="w">        </span>str<span class="w">     </span>w8,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span><span class="c1">#0xc]</span>
0000000100003f84<span class="w">        </span>mov<span class="w">     </span>w8,<span class="w"> </span><span class="c1">#0x7</span>
0000000100003f88<span class="w">        </span>str<span class="w">     </span>w8,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span><span class="c1">#0x8]</span>
0000000100003f8c<span class="w">        </span>ldr<span class="w">     </span>w8,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span><span class="c1">#0xc]</span>
0000000100003f90<span class="w">        </span>ldr<span class="w">     </span>w9,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span><span class="c1">#0x8]</span>
0000000100003f94<span class="w">        </span>add<span class="w">     </span>w8,<span class="w"> </span>w8,<span class="w"> </span>w9
0000000100003f98<span class="w">        </span>str<span class="w">     </span>w8,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span><span class="c1">#0x4]</span>
0000000100003f9c<span class="w">        </span>mov<span class="w">     </span>w0,<span class="w"> </span><span class="c1">#0x0</span>
0000000100003fa0<span class="w">        </span>add<span class="w">     </span>sp,<span class="w"> </span>sp,<span class="w"> </span><span class="c1">#0x10</span>
0000000100003fa4<span class="w">        </span>ret
</code></pre></div>

<p>Now start with the basics. You know you assigned the values 5 and 7 to some variables, and you can see those assignments on lines <code>3f7c</code> and <code>3f84</code> (referring to the last four digits of the hex numbers in the first column). Both of these lines are using the <code>mov</code> operator to copy data into a register, in this case register w8.</p>
<h1>ARM64 General-Purpose Registers</h1>
<p>ARM has 30 general-purpose, 64-bit registers. These registers can be referred to in different ways, each way dictating the number of bit that you are addressing. Remember, these registers are 64-bits wide, and they are named <code>x0</code> through <code>x30</code>.</p>
<p>But they are also named <code>w0</code> through <code>w30</code>. What is the difference? If you use the <code>x</code> names, you are addressing the full 64 bits of each register. If you use the <code>w</code> names, you are addressing the lower 32 bits of each register. In other words, using the <code>x</code> registers will result in 64-bit operations while the <code>w</code> registers will result in 32-bit operations.</p>
<p>Notice in the C code above the variables are <code>ints</code>, and the register references in the assembly are <code>w</code> registers. If I change the <code>ints</code> in the source code to <code>longs</code>:</p>
<div class="highlight"><pre><span></span><code>int main()
{
    int a,b,c;
    a=5;
    b=7;
    c=a+b;
}
</code></pre></div>

<p>Compile, and disassemble:</p>
<div class="highlight"><pre><span></span><code>foo:
(__TEXT,__text) section
_main:
0000000100003f78        sub     sp, sp, #0x20
0000000100003f7c        mov     x8, #0x5
0000000100003f80        str     x8, [sp, #0x18]
0000000100003f84        mov     x8, #0x7
0000000100003f88        str     x8, [sp, #0x10]
0000000100003f8c        ldr     x8, [sp, #0x18]
0000000100003f90        ldr     x9, [sp, #0x10]
0000000100003f94        add     x8, x8, x9
0000000100003f98        str     x8, [sp, #0x8]
0000000100003f9c        mov     w0, #0x0
0000000100003fa0        add     sp, sp, #0x20
0000000100003fa4        ret
</code></pre></div>

<p>Now the registers are being referenced with their <code>x</code> names, other than on line <code>3f9c</code>, which is likely doing something special.</p>
    </mainarticle>
</div>
<hr>
        
<div>
        <i>If you found the article helpful, please share or cite the article, and spread the word:</i>
            <p style="margin-top: 2%;">
                <span><a target="_blank" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;" title="Twitter" href="https://twitter.com/share?url=https://markdrummond.ca/arm64-assembly.html&text=A Tiny Bit of ARM64 Assembly&via="><img class="social-icons-a" src="https://markdrummond.ca/theme/images/icons/twitter.png"></a></span>
                <span><a target="_blank" title="Facebook" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;" href="https://www.facebook.com/sharer.php?u=https://markdrummond.ca/arm64-assembly.html&t=A Tiny Bit of ARM64 Assembly"><img class="social-icons-a" src="https://markdrummond.ca/theme/images/icons/facebook.png"></a></span>

                <a  target="_blank" title="Linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://markdrummond.ca/arm64-assembly.html&title=A Tiny Bit of ARM64 Assembly" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img class="social-icons-a" src="https://markdrummond.ca/theme/images/icons/linkedin.png"></a>
            </p>
</div>
<hr>
    <p><i>For any feedback or corrections, please write in to: </i><b> Mark Drummond </b></p>
        
    </maincontent>

  <!-- Analytics -->

  </div>
</body>

</html>